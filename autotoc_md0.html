<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The NEORV32 Processor - Software Framework: [The NEORV32 Processor](https://github.com/stnolting/neorv32) (RISC-V)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The NEORV32 Processor - Software Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">[The NEORV32 Processor](<a href="https://github.com/stnolting/neorv32">https://github.com/stnolting/neorv32</a>) (RISC-V) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.com/stnolting/neorv32"></a> <a href="https://github.com/stnolting/neorv32/blob/master/LICENSE"></a> <a href="https://github.com/stnolting/neorv32/releases"></a></p>
<ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#Status">Project Status</a></li>
<li><a href="#Features">Features</a></li>
<li><a href="#FPGA-Implementation-Results">FPGA Implementation Results</a></li>
<li><a href="#Performance">Performance</a></li>
<li><a href="#Top-Entities">Top Entities</a></li>
<li><a href="#Getting-Started"><b>Getting Started</b></a></li>
<li><a href="#Contribute">Contribute</a></li>
<li><a href="#Legal">Legal</a></li>
</ul>
<p>The NEORV32 Processor is a customizable microcontroller-like system on chip (SoC) that is based on the RISC-V-compliant NEORV32 CPU. The project consists of two main parts:</p>
<p>The CPU implements an <code>rv32i RISC-V</code> core with optional <code>C</code>, <code>E</code>, <code>M</code>, <code>U</code>, <code>Zicsr</code>, <code>Zifencei</code> and <code>PMP</code> (physical memory protection) extensions. It passes the official <a href="https://github.com/stnolting/neorv32_riscv_compliance">RISC-V compliance tests</a> and is compliant to the <em>Unprivileged ISA Specification <a href="https://github.com/stnolting/neorv32/blob/master/docs/riscv-privileged.pdf">Version 2.2</a></em> and a subset of the <em>Privileged Architecture Specification <a href="https://github.com/stnolting/neorv32/blob/master/docs/riscv-spec.pdf">Version 1.12-draft</a></em>.</p>
<p>If you do not want to use the NEORV32 Processor setup, you can also use the CPU in stand-alone mode and build your own SoC around it.</p>
<p>Based on the NEORV32 CPU, the NEORV32 Processor is a full-scale RISC-V microcontroller system (<b>SoC</b>) that already provides common peripherals like GPIO, serial interfaces, timers, embedded memories and an external bus interface for connectivity and custom extension. All optional features and modules beyond the base CPU can be enabled and configured via <a href="#Top-Entities">VHDL generics</a>.</p>
<p>The processor is intended as ready-to-use auxiliary processor within a larger SoC designs or as stand-alone custom microcontroller. Its top entity can be directly synthesized for any target technology without modifications.</p>
<p>This project comes with a complete software ecosystem that features core libraries for high-level usage of the provided functions and peripherals, makefiles, a runtime environment, several example programs to start with - including a free RTOS demo - and even a builtin bootloader for easy program upload via UART. All software source files provide a doxygen-based documentary (available on <a href="https://stnolting.github.io/neorv32/files.html">GitHub pages</a>).</p>
<p>The processor is intended to work "out of the box". Just synthesize the <a href="#Create-a-new-Hardware-Project">test setup</a>, upload it to your FPGA board of choice and start playing with the NEORV32. If you do not want to <a href="https://github.com/riscv/riscv-gnu-toolchain">compile the GCC toolchains</a> by yourself, you can also download <a href="https://github.com/stnolting/riscv_gcc_prebuilt">pre-compiled toolchains</a> for Linux.</p>
<p>For more information take a look at the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 data sheet</a>.</p>
<ul>
<li>RISC-V-compliant <code>rv32i</code> CPU with optional <code>C</code>, <code>E</code>, <code>M</code>, <code>U</code>, <code>Zicsr</code>, <code>Zifencei</code> and <code>PMP</code> (physical memory protection) extensions</li>
<li>GCC-based toolchain (<a href="https://github.com/stnolting/riscv_gcc_prebuilt">pre-compiled rv32i and rv32e toolchains available</a>)</li>
<li>Application compilation based on <a href="https://github.com/stnolting/neorv32/blob/master/sw/example/blink_led/makefile">GNU makefiles</a></li>
<li><a href="https://github.com/stnolting/neorv32/blob/master/docs/doxygen_makefile_sw">Doxygen-based</a> documentation of the software framework: available on <a href="https://stnolting.github.io/neorv32/files.html">GitHub pages</a></li>
<li><a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf"><b>Detailed data sheet</b></a> (pdf)</li>
<li>Completely described in behavioral, platform-independent VHDL - no primitives, macros, etc.</li>
<li>Fully synchronous design, no latches, no gated clocks</li>
<li>Small hardware footprint and high operating frequency</li>
<li>Highly configurable CPU and processor setup</li>
<li><a href="https://github.com/stnolting/neorv32/blob/master/sw/example/demo_freeRTOS">FreeRTOS port</a> available</li>
</ul>
<ul>
<li>From zero to <code><a class="el" href="bootloader_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main()</a></code>: Completely open source and documented.</li>
<li>Plain VHDL without technology-specific parts like attributes, macros or primitives.</li>
<li>Easy to use – working out of the box.</li>
<li>Clean synchronous design, no wacky combinatorial interfaces.</li>
<li>Be as small as possible – but with a reasonable size-performance tradeoff.</li>
<li>The processor has to fit in a Lattice iCE40 UltraPlus 5k FPGA running at 20+ MHz.</li>
</ul>
<p>The processor is <a href="#FPGA-Implementation-Results">synthesizable</a> (tested on <em>real hardware</em> using Intel Quartus Prime, Xilinx Vivado and Lattice Radiant/Synplify Pro) and can successfully execute all the <a href="https://github.com/stnolting/neorv32/tree/master/sw/example">provided example programs</a> including the <a href="#CoreMark-Benchmark">CoreMark benchmark</a>.</p>
<p>The processor passes the official <code>rv32i</code>, <code>rv32im</code>, <code>rv32imc</code>, <code>rv32Zicsr</code> and <code>rv32Zifencei</code> <a href="https://github.com/riscv/riscv-compliance">RISC-V compliance tests</a>.</p>
<p>The project’s change log is available in the https://github.com/stnolting/neorv32/blob/master/CHANGELOG.md "CHANGELOG.md" file in the root directory of this repository.</p>
<table class="doxtable">
<tr>
<th align="left">Project component </th><th align="left">CI status </th><th align="left">Note  </th></tr>
<tr>
<td align="left"><a href="https://github.com/stnolting/neorv32">NEORV32 processor</a> </td><td align="left"><a href="https://travis-ci.com/stnolting/neorv32"></a> </td><td align="left"><a href="https://stnolting.github.io/neorv32/files.html"></a> </td></tr>
<tr>
<td align="left"><a href="https://github.com/stnolting/riscv_gcc_prebuilt">Pre-built toolchain</a> </td><td align="left"><a href="https://travis-ci.com/stnolting/riscv_gcc_prebuilt"></a> </td><td align="left"></td></tr>
<tr>
<td align="left"><a href="https://github.com/stnolting/neorv32_riscv_compliance">RISC-V compliance test</a> </td><td align="left"><a href="https://travis-ci.com/stnolting/neorv32_riscv_compliance"></a> </td><td align="left"></td></tr>
</table>
<ul>
<li>Add AXI(-Lite) bridges</li>
<li>Synthesis results (+ wrappers?) for more platforms</li>
<li>Maybe port additional RTOSs (like <a href="https://github.com/zephyrproject-rtos/zephyr">Zephyr</a> or <a href="https://www.riot-os.org">RIOT</a>)</li>
<li>Implement further CPU extensions:<ul>
<li>Atomic operations (<code>A</code>)</li>
<li>Bitmanipulation operations (<code>B</code>), when they are "official"</li>
<li>Floating-point instructions (<code>F</code>)</li>
<li>...</li>
</ul>
</li>
</ul>
<p>The full-blown data sheet of the NEORV32 Processor/CPU is available as pdf file: <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 data sheet</a>.</p>
<div class="image">
<img src="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/figures/neorv32_processor.png" alt="neorv32 Overview"/>
</div>
<p>The NEORV32 Processor provides a full-scale microcontroller-like SoC based on the NEORV32 CPU. The setup is highly customizable via the processor's top generics.</p>
<ul>
<li>Optional processor-internal data and instruction memories (<b>DMEM</b> / <b>IMEM</b>)</li>
<li>Optional internal <b>Bootloader</b> with UART console and automatic SPI flash boot option</li>
<li>Optional machine system timer (<b>MTIME</b>), RISC-V-compliant</li>
<li>Optional universal asynchronous receiver and transmitter (<b>UART</b>) with simulation output option via text.io</li>
<li>Optional 8/16/24/32-bit serial peripheral interface controller (<b>SPI</b>) with 8 dedicated chip select lines</li>
<li>Optional two wire serial interface controller (<b>TWI</b>), compatible to the I²C standard</li>
<li>Optional general purpose parallel IO port (<b>GPIO</b>), 32xOut &amp; 32xIn, with pin-change interrupt</li>
<li>Optional 32-bit external bus interface, Wishbone b4 compliant (<b>WISHBONE</b>), <em>standard</em> or <em>pipelined</em> handshake/transactions mode</li>
<li>Optional watchdog timer (<b>WDT</b>)</li>
<li>Optional PWM controller with 4 channels and 8-bit duty cycle resolution (<b>PWM</b>)</li>
<li>Optional GARO-based true random number generator (<b>TRNG</b>)</li>
<li>Optional custom functions unit (<b>CFU</b>) for tightly-coupled custom co-processors</li>
<li>System configuration information memory to check hardware configuration by software (<b>SYSINFO</b>)</li>
</ul>
<div class="image">
<img src="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/figures/neorv32_cpu.png" alt="neorv32 Overview"/>
</div>
<p>The CPU is <a href="https://github.com/stnolting/neorv32_riscv_compliance">compliant</a> to the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/riscv-spec.pdf">official RISC-V specifications (2.2)</a> including a subset of the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/riscv-spec.pdf">RISC-V privileged architecture specifications (1.12-draft)</a>.</p>
<p>More information regarding the CPU including a detailed list of the instruction set and the available CSRs can be found in the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 data sheet</a>.</p>
<p><b>General</b>:</p><ul>
<li>Modified Harvard architecture (separate CPU interfaces for data and instructions; NEORV32 processor: Single processor-internal bus via I/D mux)</li>
<li>Two stages in-order pipeline (FETCH, EXECUTE); each stage uses a multi-cycle processing scheme</li>
<li>No hardware support of unaligned accesses - they will trigger an exception</li>
<li>Little-endian byte order</li>
<li>All reserved or unimplemented instructions will raise an illegal instruction exception</li>
<li>Privilege levels: <code>machine</code> mode, <code>user</code> mode (if enabled via <code>U</code> extension)</li>
</ul>
<p><b>RV32I base instruction set</b> (<code>I</code> extension):</p><ul>
<li>ALU instructions: <code>LUI</code> <code>AUIPC</code> <code>ADDI</code> <code>SLTI</code> <code>SLTIU</code> <code>XORI</code> <code>ORI</code> <code>ANDI</code> <code>SLLI</code> <code>SRLI</code> <code>SRAI</code> <code>ADD</code> <code>SUB</code> <code>SLL</code> <code>SLT</code> <code>SLTU</code> <code>XOR</code> <code>SRL</code> <code>SRA</code> <code>OR</code> <code>AND</code></li>
<li>Jump and branch instructions: <code>JAL</code> <code>JALR</code> <code>BEQ</code> <code>BNE</code> <code>BLT</code> <code>BGE</code> <code>BLTU</code> <code>BGEU</code></li>
<li>Memory instructions: <code>LB</code> <code>LH</code> <code>LW</code> <code>LBU</code> <code>LHU</code> <code>SB</code> <code>SH</code> <code>SW</code></li>
<li>System instructions: <code>ECALL</code> <code>EBREAK</code> <code>FENCE</code></li>
</ul>
<p><b>Compressed instructions</b> (<code>C</code> extension):</p><ul>
<li>ALU instructions: <code>C.ADDI4SPN</code> <code>C.ADDI</code> <code>C.ADD</code> <code>C.ADDI16SP</code> <code>C.LI</code> <code>C.LUI</code> <code>C.SLLI</code> <code>C.SRLI</code> <code>C.SRAI</code> <code>C.ANDI</code> <code>C.SUB</code> <code>C.XOR</code> <code>C.OR</code> <code>C.AND</code> <code>C.MV</code> <code>C.NOP</code></li>
<li>Jump and branch instructions: <code>C.J</code> <code>C.JAL</code> <code>C.JR</code> <code>C.JALR</code> <code>C.BEQZ</code> <code>C.BNEZ</code></li>
<li>Memory instructions: <code>C.LW</code> <code>C.SW</code> <code>C.LWSP</code> <code>C.SWSP</code></li>
<li>System instructions: <code>C.EBREAK</code> (only with <code>Zicsr</code> extension)</li>
</ul>
<p><b>Embedded CPU version</b> (<code>E</code> extension):</p><ul>
<li>Reduced register file (only the 16 lowest registers)</li>
</ul>
<p><b>Integer multiplication and division hardware</b> (<code>M</code> extension):</p><ul>
<li>Multiplication instructions: <code>MUL</code> <code>MULH</code> <code>MULHSU</code> <code>MULHU</code></li>
<li>Division instructions: <code>DIV</code> <code>DIVU</code> <code>REM</code> <code>REMU</code></li>
<li>By default, the multiplier and divider cores use an iterative bit-serial processing scheme</li>
<li>Multiplications can be mapped to DSPs via the <code>FAST_MUL_EN</code> generic to increase performance</li>
</ul>
<p><b>Privileged architecture / CSR access</b> (<code>Zicsr</code> extension):</p><ul>
<li>Privilege levels: <code>M-mode</code> (Machine mode)</li>
<li>CSR access instructions: <code>CSRRW</code> <code>CSRRS</code> <code>CSRRC</code> <code>CSRRWI</code> <code>CSRRSI</code> <code>CSRRCI</code></li>
<li>System instructions: <code>MRET</code> <code>WFI</code></li>
<li>Counter CSRs: <code>cycle</code> <code>cycleh</code> <code>instret</code> <code>instreth</code> <code>time</code> <code>timeh</code> <code>mcycle</code> <code>mcycleh</code> <code>minstret</code> <code>minstreth</code></li>
<li>Machine CSRs: <code>mstatus</code> <code>misa</code>(read-only!) <code>mie</code> <code>mtvec</code> <code>mscratch</code> <code>mepc</code> <code>mcause</code> <code>mtval</code> <code>mip</code> <code>mvendorid</code> https://github.com/riscv/riscv-isa-manual/blob/master/marchid.md "`marchid`" <code>mimpid</code> <code>mhartid</code> <code>mzext</code>(custom)</li>
<li>Supported exceptions and interrupts:<ul>
<li>Misaligned instruction address</li>
<li>Instruction access fault</li>
<li>Illegal instruction</li>
<li>Breakpoint (via <code>ebreak</code> instruction)</li>
<li>Load address misaligned</li>
<li>Load access fault</li>
<li>Store address misaligned</li>
<li>Store access fault</li>
<li>Environment call from M-mode (via <code>ecall</code> instruction)</li>
<li>Machine timer interrupt <code>mti</code> (via processor's MTIME unit)</li>
<li>Machine software interrupt <code>msi</code> (via external signal)</li>
<li>Machine external interrupt <code>mei</code> (via external signal)</li>
<li>Four fast interrupt requests (custom extension)</li>
</ul>
</li>
</ul>
<p><b>Privileged architecture / User mode</b> (<code>U</code> extension, requires <code>Zicsr</code> extension):</p><ul>
<li>Privilege levels: <code>M-mode</code> (Machine mode) + <code>U-mode</code> (User mode)</li>
</ul>
<p><b>Privileged architecture / FENCE.I</b> (<code>Zifencei</code> extension):</p><ul>
<li>System instructions: <code>FENCE.I</code></li>
</ul>
<p><b>Privileged architecture / Physical memory protection</b> (<code>PMP</code>, requires <code>Zicsr</code> extension):</p><ul>
<li>Additional machine CSRs: <code>pmpcfg0</code> <code>pmpcfg1</code> <code>pmpaddr0</code> <code>pmpaddr1</code> <code>pmpaddr2</code> <code>pmpaddr3</code> <code>pmpaddr4</code> <code>pmpaddr5</code> <code>pmpaddr6</code> <code>pmpaddr7</code></li>
</ul>
<ul>
<li><code>misa</code> CSR is read-only - no dynamic enabling/disabling of synthesized CPU extensions during runtime; for compatibility: write accesses (in m-mode) are ignored and do not cause an exception</li>
<li>The physical memory protection (<b>PMP</b>) only supports <code>NAPOT</code> mode, a minimal granularity of 8 bytes and only up to 8 regions</li>
</ul>
<p>The NEORV32-specific extensions are always enabled and are indicated via the <code>X</code> bit in the <code>misa</code> CSR.</p>
<ul>
<li>Four <em>fast interrupt</em> request channels with according control/status bits in <code>mie</code> and <code>mip</code> and custom exception codes in <code>mcause</code></li>
<li><code>mzext</code> CSR to check for implemented <code>Z*</code> CPU extensions (like <code>Zifencei</code>)</li>
</ul>
<p>This chapter shows exemplary implementation results of the NEORV32 CPU for an <b>Intel Cyclone IV EP4CE22F17C6N FPGA</b> on a DE0-nano board. The design was synthesized using <b>Intel Quartus Prime Lite 19.1</b> ("balanced implementation"). The timing information is derived from the Timing Analyzer / Slow 1200mV 0C Model. If not otherwise specified, the default configuration of the CPU's generics is assumed (for example no PMP). No constraints were used at all.</p>
<p>Results generated for hardware version: <code>1.4.4.8</code></p>
<table class="doxtable">
<tr>
<th align="left">CPU Configuration </th><th align="center">LEs </th><th align="center">FFs </th><th align="center">Memory bits </th><th align="center">DSPs </th><th align="center">f_max  </th></tr>
<tr>
<td align="left"><code>rv32i</code> </td><td align="center">983 </td><td align="center">438 </td><td align="center">2048 </td><td align="center">0 </td><td align="center">~120 MHz </td></tr>
<tr>
<td align="left"><code>rv32i</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> </td><td align="center">1877 </td><td align="center">802 </td><td align="center">2048 </td><td align="center">0 </td><td align="center">~112 MHz </td></tr>
<tr>
<td align="left"><code>rv32im</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> </td><td align="center">2374 </td><td align="center">1048 </td><td align="center">2048 </td><td align="center">0 </td><td align="center">~110 MHz </td></tr>
<tr>
<td align="left"><code>rv32imc</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> </td><td align="center">2650 </td><td align="center">1064 </td><td align="center">2048 </td><td align="center">0 </td><td align="center">~110 MHz </td></tr>
<tr>
<td align="left"><code>rv32emc</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> </td><td align="center">2680 </td><td align="center">1061 </td><td align="center">1024 </td><td align="center">0 </td><td align="center">~110 MHz </td></tr>
</table>
<p>Results generated for hardware version: <code>1.4.4.8</code></p>
<table class="doxtable">
<tr>
<th align="left">Module </th><th align="left">Description </th><th align="right">LEs </th><th align="right">FFs </th><th align="right">Memory bits </th><th align="right">DSPs  </th></tr>
<tr>
<td align="left">BOOT ROM </td><td align="left">Bootloader ROM (default 4kB) </td><td align="right">4 </td><td align="right">1 </td><td align="right">32 768 </td><td align="right">0 </td></tr>
<tr>
<td align="left">BUSSWITCH </td><td align="left">Mux for CPU I &amp; D interfaces </td><td align="right">62 </td><td align="right">8 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">CFU </td><td align="left">Custom functions unit </td><td align="right">- </td><td align="right">- </td><td align="right">- </td><td align="right">- </td></tr>
<tr>
<td align="left">DMEM </td><td align="left">Processor-internal data memory (default 8kB) </td><td align="right">13 </td><td align="right">2 </td><td align="right">65 536 </td><td align="right">0 </td></tr>
<tr>
<td align="left">GPIO </td><td align="left">General purpose input/output ports </td><td align="right">66 </td><td align="right">65 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">IMEM </td><td align="left">Processor-internal instruction memory (default 16kb) </td><td align="right">7 </td><td align="right">2 </td><td align="right">131 072 </td><td align="right">0 </td></tr>
<tr>
<td align="left">MTIME </td><td align="left">Machine system timer </td><td align="right">268 </td><td align="right">166 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">PWM </td><td align="left">Pulse-width modulation controller </td><td align="right">72 </td><td align="right">69 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">SPI </td><td align="left">Serial peripheral interface </td><td align="right">184 </td><td align="right">125 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">SYSINFO </td><td align="left">System configuration information memory </td><td align="right">11 </td><td align="right">9 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">TRNG </td><td align="left">True random number generator </td><td align="right">132 </td><td align="right">105 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">TWI </td><td align="left">Two-wire interface </td><td align="right">74 </td><td align="right">44 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">UART </td><td align="left">Universal asynchronous receiver/transmitter </td><td align="right">175 </td><td align="right">132 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">WDT </td><td align="left">Watchdog timer </td><td align="right">58 </td><td align="right">45 </td><td align="right">0 </td><td align="right">0 </td></tr>
<tr>
<td align="left">WISHBONE </td><td align="left">External memory interface (<code>MEM_EXT_REG_STAGES</code> = 2) </td><td align="right">106 </td><td align="right">104 </td><td align="right">0 </td><td align="right">0 </td></tr>
</table>
<p>Exemplary processor implementation results for different FPGA platforms. The processor setup uses <em>the default peripheral configuration</em> (like no <em>CFU</em> and no <em>TRNG</em>), no external memory interface and only internal instruction and data memories. IMEM uses 16kB and DMEM uses 8kB memory space. The setup's top entity connects most of the processor's <a href="https://github.com/stnolting/neorv32/blob/master/rtl/core/neorv32_top.vhd">top entity</a> signals to FPGA pins - except for the Wishbone bus and the interrupt signals.</p>
<p>Results generated for hardware version: <code>1.4.4.8</code></p>
<table class="doxtable">
<tr>
<th align="left">Vendor </th><th align="left">FPGA </th><th align="left">Board </th><th align="left">Toolchain </th><th align="left">Strategy </th><th align="left">CPU Configuration </th><th align="left">LUT / LE </th><th align="left">FF / REG </th><th align="left">DSP </th><th align="left">Memory Bits </th><th align="left">BRAM / EBR </th><th align="left">SPRAM </th><th align="right">Frequency  </th></tr>
<tr>
<td align="left">Intel </td><td align="left">Cyclone IV <code>EP4CE22F17C6N</code> </td><td align="left">Terasic DE0-Nano </td><td align="left">Quartus Prime Lite 19.1 </td><td align="left">balanced </td><td align="left"><code>rv32imc</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> + <code>PMP</code> </td><td align="left">4008 (18%) </td><td align="left">1849 (9%) </td><td align="left">0 (0%) </td><td align="left">231424 (38%) </td><td align="left">- </td><td align="left">- </td><td align="right">105 MHz </td></tr>
<tr>
<td align="left">Lattice </td><td align="left">iCE40 UltraPlus <code>iCE40UP5K-SG48I</code> </td><td align="left">Upduino v2.0 </td><td align="left">Radiant 2.1 (Synplify Pro) </td><td align="left">default </td><td align="left"><code>rv32ic</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> </td><td align="left">4296 (81%) </td><td align="left">1611 (30%) </td><td align="left">0 (0%) </td><td align="left">- </td><td align="left">12 (40%) </td><td align="left">4 (100%) </td><td align="right"><em>c</em> 22.5 MHz </td></tr>
<tr>
<td align="left">Xilinx </td><td align="left">Artix-7 <code>XC7A35TICSG324-1L</code> </td><td align="left">Arty A7-35T </td><td align="left">Vivado 2019.2 </td><td align="left">default </td><td align="left"><code>rv32imc</code> + <code>u</code> + <code>Zicsr</code> + <code>Zifencei</code> + <code>PMP</code> </td><td align="left">2390 (11%) </td><td align="left">1888 (5%) </td><td align="left">0 (0%) </td><td align="left">- </td><td align="left">8 (16%) </td><td align="left">- </td><td align="right"><em>c</em> 100 MHz </td></tr>
</table>
<p>**_Notes_**</p><ul>
<li>The Lattice iCE40 UltraPlus setup uses the FPGA's SPRAM memory primitives for the internal IMEM and DMEM (each 64kb). The FPGA-specific memory components can be found in <a href="https://github.com/stnolting/neorv32/blob/master/rtl/fpga_specific/lattice_ice40up"><code>rtl/fpga_specific</code></a>.</li>
<li>The clock frequencies marked with a "c" are constrained clocks. The remaining ones are <em>f_max</em> results from the place and route timing reports.</li>
<li>The Upduino and the Arty board have on-board SPI flash memories for storing the FPGA configuration. These device can also be used by the default NEORV32 bootloader to store and automatically boot an application program after reset (both tested successfully).</li>
<li>The setups with <code>PMP</code> implement 2 regions with a minimal granularity of 32kB.</li>
</ul>
<p>The <a href="https://www.eembc.org/coremark">CoreMark CPU benchmark</a> was executed on the NEORV32 and is available in the <a href="https://github.com/stnolting/neorv32/blob/master/sw/example/coremark">sw/example/coremark</a> project folder. This benchmark tests the capabilities of a CPU itself rather than the functions provided by the whole system / SoC.</p>
<p>Results generated for hardware version: <code>1.4.4.8</code></p>
<div class="fragment"><div class="line">**Configuration**</div><div class="line">Hardware:    32kB IMEM, 16kB DMEM, 100MHz clock</div><div class="line">CoreMark:    2000 iterations, MEM_METHOD is MEM_STACK</div><div class="line">Compiler:    RISCV32-GCC 10.1.0 (rv32i toolchain)</div><div class="line">Flags:       default, see makefile</div><div class="line">Peripherals: UART for printing the results</div></div><!-- fragment --><table class="doxtable">
<tr>
<th align="left">CPU </th><th align="center">Executable Size </th><th align="center">Optimization </th><th align="center">CoreMark Score </th><th align="center">CoreMarks/MHz  </th></tr>
<tr>
<td align="left"><code>rv32i</code> </td><td align="center">26 940 bytes </td><td align="center"><code>-O3</code> </td><td align="center">33.89 </td><td align="center"><b>0.3389</b> </td></tr>
<tr>
<td align="left"><code>rv32im</code> </td><td align="center">25 772 bytes </td><td align="center"><code>-O3</code> </td><td align="center">64.51 </td><td align="center"><b>0.6451</b> </td></tr>
<tr>
<td align="left"><code>rv32imc</code> </td><td align="center">20 524 bytes </td><td align="center"><code>-O3</code> </td><td align="center">64.51 </td><td align="center"><b>0.6451</b> </td></tr>
<tr>
<td align="left"><code>rv32imc</code> + <code>FAST_MUL_EN</code> </td><td align="center">20 524 bytes </td><td align="center"><code>-O3</code> </td><td align="center">80.00 </td><td align="center"><b>0.8000</b> </td></tr>
</table>
<p>The <code>FAST_MUL_EN</code> configuration uses DSPs for the multiplier of the <code>M</code> extension (enabled via the <code>FAST_MUL_EN</code> generic).</p>
<p>When the <code>C</code> extension is enabled, branches to an unaligned uncompressed instruction require additional instruction fetch cycles.</p>
<p>The NEORV32 CPU is based on a two-stages pipelined architecutre. Each stage uses a multi-cycle processing scheme. Hence, each instruction requires several clock cycles to execute (2 cycles for ALU operations, ..., 40 cycles for divisions). The average CPI (cycles per instruction) depends on the instruction mix of a specific applications and also on the available CPU extensions.</p>
<p>Please note that the CPU-internal shifter (e.g. for the <code>SLL</code> instruction) as well as the multiplier and divider of the <code>M</code> extension use a bit-serial approach and require several cycles for completion.</p>
<p>The following table shows the performance results for successfully running 2000 CoreMark iterations, which reflects a pretty good "real-life" work load. The average CPI is computed by dividing the total number of required clock cycles (only the timed core to avoid distortion due to IO wait cycles; sampled via the <code>cycle[h]</code> CSRs) by the number of executed instructions (<code>instret[h]</code> CSRs). The executables were generated using optimization <code>-O3</code>.</p>
<p>Results generated for hardware version: <code>1.4.4.8</code></p>
<table class="doxtable">
<tr>
<th align="left">CPU </th><th align="right">Required Clock Cycles </th><th align="right">Executed Instructions </th><th align="center">Average CPI  </th></tr>
<tr>
<td align="left"><code>rv32i</code> </td><td align="right">5 945 938 586 </td><td align="right">1 469 587 406 </td><td align="center"><b>4.05</b> </td></tr>
<tr>
<td align="left"><code>rv32im</code> </td><td align="right">3 110 282 586 </td><td align="right">602 225 760 </td><td align="center"><b>5.16</b> </td></tr>
<tr>
<td align="left"><code>rv32imc</code> </td><td align="right">3 172 969 968 </td><td align="right">615 388 924 </td><td align="center"><b>5.16</b> </td></tr>
<tr>
<td align="left"><code>rv32imc</code> <code>FAST_MUL_EN</code> </td><td align="right">2 590 417 968 </td><td align="right">615 388 890 </td><td align="center"><b>4.21</b> </td></tr>
</table>
<p>The <code>FAST_MUL_EN</code> configuration uses DSPs for the multiplier of the <code>M</code> extension (enabled via the <code>FAST_MUL_EN</code> generic).</p>
<p>When the <code>C</code> extension is enabled, branches to an unaligned uncompressed instruction require additional instruction fetch cycles.</p>
<p>The top entity of the <b>NEORV32 Processor</b> is <a href="https://github.com/stnolting/neorv32/blob/master/rtl/core/neorv32_top.vhd"><b>neorv32_top.vhd</b></a> (from <code>rtl/core</code>). Just instantiate this file in your project and you are ready to go! All signals of this top entity are of type <em>std_ulogic</em> or <em>std_ulogic_vector</em>, respectively (except for the TWI signals, which are of type <em>std_logic</em>).</p>
<p>The top entity of the <b>NEORV32 CPU</b> is <a href="https://github.com/stnolting/neorv32/blob/master/rtl/core/neorv32_cpu.vhd"><b>neorv32_cpu.vhd</b></a> (from <code>rtl/core</code>). All signals of this top entity are of type <em>std_ulogic</em> or <em>std_ulogic_vector</em>, respectively.</p>
<p>Use the generics to configure the processor/CPU according to your needs. Each generic is initilized with the default configuration. Detailed information regarding the signals and configuration generics can be found in the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 documentary</a>.</p>
<p>Alternative top entities, like the simplified <a href="#Create-a-new-Hardware-Project">"hello world" test setup</a> or CPU/Processor wrappers with resolved port signal types (i.e. <em>std_logic</em>), can be found in <a href="https://github.com/stnolting/neorv32/blob/master/rtl/top_templates"><code>rtl/top_templates</code></a>.</p>
<div class="fragment"><div class="line"><span class="keywordflow">entity </span>neorv32_cpu <span class="keywordflow">is</span></div><div class="line">  <span class="keywordflow">generic</span> <span class="vhdlchar">(</span></div><div class="line"><span class="keyword">    -- General --</span></div><div class="line">    <span class="vhdlchar">HW_THREAD_ID</span>                 <span class="vhdlchar">:</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span><span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- hardware thread id</span></div><div class="line">    <span class="vhdlchar">CPU_BOOT_ADDR</span>                <span class="vhdlchar">:</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span><span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- cpu boot address</span></div><div class="line"><span class="keyword">    -- RISC-V CPU Extensions --</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_C</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement compressed extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_E</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement embedded RF extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_M</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement muld/div extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_U</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement user mode extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_Zicsr</span>    <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">  -- implement CSR system?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_Zifencei</span> <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">  -- implement instruction stream sync.?</span></div><div class="line"><span class="keyword">    -- Extension Options --</span></div><div class="line">    FAST_MUL_EN                  : <span class="comment">boolean</span> := false; -- <span class="keywordflow">use</span> DSPs <span class="keywordflow">for</span> M extension&#39;s multiplier</div><div class="line"><span class="keyword">    -- Physical Memory Protection (PMP) --</span></div><div class="line">    <span class="vhdlchar">PMP_USE</span>                      <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement PMP?</span></div><div class="line">    <span class="vhdlchar">PMP_NUM_REGIONS</span>              <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">4</span>;<span class="keyword">     -- number of regions (max 8)</span></div><div class="line">    <span class="vhdlchar">PMP_GRANULARITY</span>              <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">14</span><span class="keyword">     -- minimal region granularity (1=8B, 2=16B, 3=32B, ...) default is 64k</span></div><div class="line">  <span class="vhdlchar">)</span>;</div><div class="line">  <span class="keywordflow">port</span> <span class="vhdlchar">(</span></div><div class="line"><span class="keyword">    -- global control --</span></div><div class="line">    <span class="vhdlchar">clk_i</span>          <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global clock, rising edge</span></div><div class="line">    <span class="vhdlchar">rstn_i</span>         <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global reset, low-active, async</span></div><div class="line"><span class="keyword">    -- instruction bus interface --</span></div><div class="line">    <span class="vhdlchar">i_bus_addr_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus access address</span></div><div class="line">    <span class="vhdlchar">i_bus_rdata_i</span>  <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus read data</span></div><div class="line">    <span class="vhdlchar">i_bus_wdata_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus write data</span></div><div class="line">    <span class="vhdlchar">i_bus_ben_o</span>    <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">03</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- byte enable</span></div><div class="line">    <span class="vhdlchar">i_bus_we_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- write enable</span></div><div class="line">    <span class="vhdlchar">i_bus_re_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- read enable</span></div><div class="line">    <span class="vhdlchar">i_bus_cancel_o</span> <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- cancel current bus transaction</span></div><div class="line">    <span class="vhdlchar">i_bus_ack_i</span>    <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- bus transfer acknowledge</span></div><div class="line">    <span class="vhdlchar">i_bus_err_i</span>    <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- bus transfer error</span></div><div class="line">    <span class="vhdlchar">i_bus_fence_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- executed FENCEI operation</span></div><div class="line"><span class="keyword">    -- data bus interface --</span></div><div class="line">    <span class="vhdlchar">d_bus_addr_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus access address</span></div><div class="line">    <span class="vhdlchar">d_bus_rdata_i</span>  <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus read data</span></div><div class="line">    <span class="vhdlchar">d_bus_wdata_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdlchar">data_width_c</span><span class="vhdlchar">-</span><span class="vhdllogic"></span><span class="vhdllogic">1</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- bus write data</span></div><div class="line">    <span class="vhdlchar">d_bus_ben_o</span>    <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">03</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- byte enable</span></div><div class="line">    <span class="vhdlchar">d_bus_we_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- write enable</span></div><div class="line">    <span class="vhdlchar">d_bus_re_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- read enable</span></div><div class="line">    <span class="vhdlchar">d_bus_cancel_o</span> <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- cancel current bus transaction</span></div><div class="line">    <span class="vhdlchar">d_bus_ack_i</span>    <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- bus transfer acknowledge</span></div><div class="line">    <span class="vhdlchar">d_bus_err_i</span>    <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- bus transfer error</span></div><div class="line">    <span class="vhdlchar">d_bus_fence_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- executed FENCE operation</span></div><div class="line"><span class="keyword">    -- system time input from MTIME --</span></div><div class="line">    <span class="vhdlchar">time_i</span>         <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">63</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- current system time</span></div><div class="line"><span class="keyword">    -- interrupts (risc-v compliant) --</span></div><div class="line">    <span class="vhdlchar">msw_irq_i</span>      <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- machine software interrupt</span></div><div class="line">    <span class="vhdlchar">mext_irq_i</span>     <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- machine external interrupt</span></div><div class="line">    <span class="vhdlchar">mtime_irq_i</span>    <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- machine timer interrupt</span></div><div class="line"><span class="keyword">    -- fast interrupts (custom) --</span></div><div class="line">    <span class="vhdlchar">firq_i</span>         <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">3</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span></div><div class="line">  <span class="vhdlchar">)</span>;</div><div class="line"><span class="keywordflow">end</span> <span class="vhdlchar">neorv32_cpu</span>;</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="keywordflow">entity </span>neorv32_top <span class="keywordflow">is</span></div><div class="line">  <span class="keywordflow">generic</span> <span class="vhdlchar">(</span></div><div class="line"><span class="keyword">    -- General --</span></div><div class="line">    <span class="vhdlchar">CLOCK_FREQUENCY</span>              <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span>;<span class="keyword">      -- clock frequency of clk_i in Hz</span></div><div class="line">    <span class="vhdlchar">BOOTLOADER_USE</span>               <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement processor-internal bootloader?</span></div><div class="line">    <span class="vhdlchar">USER_CODE</span>                    <span class="vhdlchar">:</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">x</span><span class="vhdllogic">&quot;00000000&quot;</span>;<span class="keyword"> -- custom user code</span></div><div class="line"><span class="keyword">    -- RISC-V CPU Extensions --</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_C</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement compressed extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_E</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement embedded RF extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_M</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement muld/div extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_U</span>        <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement user mode extension?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_Zicsr</span>    <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement CSR system?</span></div><div class="line">    <span class="vhdlchar">CPU_EXTENSION_RISCV_Zifencei</span> <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement instruction stream sync.?</span></div><div class="line"><span class="keyword">    -- Extension Options --</span></div><div class="line">    FAST_MUL_EN                  : <span class="comment">boolean</span> := false; -- <span class="keywordflow">use</span> DSPs <span class="keywordflow">for</span> M extension&#39;s multiplier</div><div class="line"><span class="keyword">    -- Physical Memory Protection (PMP) --</span></div><div class="line">    <span class="vhdlchar">PMP_USE</span>                      <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword"> -- implement PMP?</span></div><div class="line">    <span class="vhdlchar">PMP_NUM_REGIONS</span>              <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">4</span>;<span class="keyword">     -- number of regions (max 8)</span></div><div class="line">    <span class="vhdlchar">PMP_GRANULARITY</span>              <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">14</span>;<span class="keyword">    -- minimal region granularity (1=8B, 2=16B, 3=32B, ...) default is 64kB</span></div><div class="line"><span class="keyword">    -- Internal Instruction memory --</span></div><div class="line">    <span class="vhdlchar">MEM_INT_IMEM_USE</span>             <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement processor-internal instruction memory</span></div><div class="line">    <span class="vhdlchar">MEM_INT_IMEM_SIZE</span>            <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">16</span><span class="vhdlchar">*</span><span class="vhdllogic"></span><span class="vhdllogic">1024</span>;<span class="keyword"> -- size of processor-internal instruction memory in bytes</span></div><div class="line">    <span class="vhdlchar">MEM_INT_IMEM_ROM</span>             <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement processor-internal instruction memory as ROM</span></div><div class="line"><span class="keyword">    -- Internal Data memory --</span></div><div class="line">    <span class="vhdlchar">MEM_INT_DMEM_USE</span>             <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement processor-internal data memory</span></div><div class="line">    <span class="vhdlchar">MEM_INT_DMEM_SIZE</span>            <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">8</span><span class="vhdlchar">*</span><span class="vhdllogic"></span><span class="vhdllogic">1024</span>;<span class="keyword"> -- size of processor-internal data memory in bytes</span></div><div class="line"><span class="keyword">    -- External memory interface --</span></div><div class="line">    <span class="vhdlchar">MEM_EXT_USE</span>                  <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement external memory bus interface?</span></div><div class="line">    <span class="vhdlchar">MEM_EXT_REG_STAGES</span>           <span class="vhdlchar">:</span> <span class="comment">natural</span> <span class="vhdlchar">:=</span> <span class="vhdllogic"></span><span class="vhdllogic">2</span>;<span class="keyword">      -- number of interface register stages (0,1,2)</span></div><div class="line"><span class="keyword">    -- Processor peripherals --</span></div><div class="line">    <span class="vhdlchar">IO_GPIO_USE</span>                  <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement general purpose input/output port unit (GPIO)?</span></div><div class="line">    <span class="vhdlchar">IO_MTIME_USE</span>                 <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement machine system timer (MTIME)?</span></div><div class="line">    <span class="vhdlchar">IO_UART_USE</span>                  <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement universal asynchronous receiver/transmitter (UART)?</span></div><div class="line">    <span class="vhdlchar">IO_SPI_USE</span>                   <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement serial peripheral interface (SPI)?</span></div><div class="line">    <span class="vhdlchar">IO_TWI_USE</span>                   <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement two-wire interface (TWI)?</span></div><div class="line">    <span class="vhdlchar">IO_PWM_USE</span>                   <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement pulse-width modulation unit (PWM)?</span></div><div class="line">    <span class="vhdlchar">IO_WDT_USE</span>                   <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">true</span>;<span class="keyword">   -- implement watch dog timer (WDT)?</span></div><div class="line">    <span class="vhdlchar">IO_TRNG_USE</span>                  <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span>;<span class="keyword">  -- implement true random number generator (TRNG)?</span></div><div class="line">    <span class="vhdlchar">IO_CFU_USE</span>                   <span class="vhdlchar">:</span> <span class="comment">boolean</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">false</span><span class="keyword">   -- implement custom functions unit (CFU)?</span></div><div class="line">  <span class="vhdlchar">)</span>;</div><div class="line">  <span class="keywordflow">port</span> <span class="vhdlchar">(</span></div><div class="line"><span class="keyword">    -- Global control --</span></div><div class="line">    <span class="vhdlchar">clk_i</span>      <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global clock, rising edge</span></div><div class="line">    <span class="vhdlchar">rstn_i</span>     <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global reset, low-active, async</span></div><div class="line"><span class="keyword">    -- Wishbone bus interface (available if MEM_EXT_USE = true) --</span></div><div class="line">    <span class="vhdlchar">wb_adr_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- address</span></div><div class="line">    <span class="vhdlchar">wb_dat_i</span>   <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- read data</span></div><div class="line">    <span class="vhdlchar">wb_dat_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- write data</span></div><div class="line">    <span class="vhdlchar">wb_we_o</span>    <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- read/write</span></div><div class="line">    <span class="vhdlchar">wb_sel_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">03</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- byte enable</span></div><div class="line">    <span class="vhdlchar">wb_stb_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- strobe</span></div><div class="line">    <span class="vhdlchar">wb_cyc_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- valid cycle</span></div><div class="line">    <span class="vhdlchar">wb_ack_i</span>   <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- transfer acknowledge</span></div><div class="line">    <span class="vhdlchar">wb_err_i</span>   <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- transfer error</span></div><div class="line"><span class="keyword">    -- Advanced memory control signals (available if MEM_EXT_USE = true) --</span></div><div class="line">    <span class="vhdlchar">fence_o</span>    <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- indicates an executed FENCE operation</span></div><div class="line">    <span class="vhdlchar">fencei_o</span>   <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- indicates an executed FENCEI operation</span></div><div class="line"><span class="keyword">    -- GPIO (available if IO_GPIO_USE = true) --</span></div><div class="line">    <span class="vhdlchar">gpio_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- parallel output</span></div><div class="line">    <span class="vhdlchar">gpio_i</span>     <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">31</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">(</span><span class="keywordflow">others</span> <span class="vhdlchar">=</span><span class="vhdlchar">&gt;</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="vhdlchar">)</span>;<span class="keyword"> -- parallel input</span></div><div class="line"><span class="keyword">    -- UART (available if IO_UART_USE = true) --</span></div><div class="line">    <span class="vhdlchar">uart_txd_o</span> <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- UART send data</span></div><div class="line">    <span class="vhdlchar">uart_rxd_i</span> <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- UART receive data</span></div><div class="line"><span class="keyword">    -- SPI (available if IO_SPI_USE = true) --</span></div><div class="line">    <span class="vhdlchar">spi_sck_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- SPI serial clock</span></div><div class="line">    <span class="vhdlchar">spi_sdo_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- controller data out, peripheral data in</span></div><div class="line">    <span class="vhdlchar">spi_sdi_i</span>  <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- controller data in, peripheral data out</span></div><div class="line">    <span class="vhdlchar">spi_csn_o</span>  <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">07</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- SPI CS</span></div><div class="line"><span class="keyword">    -- TWI (available if IO_TWI_USE = true) --</span></div><div class="line">    <span class="vhdlchar">twi_sda_io</span> <span class="vhdlchar">:</span> <span class="keywordflow">inout</span> <span class="comment">std_logic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdlchar">H</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- twi serial data line</span></div><div class="line">    <span class="vhdlchar">twi_scl_io</span> <span class="vhdlchar">:</span> <span class="keywordflow">inout</span> <span class="comment">std_logic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdlchar">H</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- twi serial clock line</span></div><div class="line"><span class="keyword">    -- PWM (available if IO_PWM_USE = true) --</span></div><div class="line">    <span class="vhdlchar">pwm_o</span>      <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">03</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- pwm channels</span></div><div class="line"><span class="keyword">    -- Interrupts --</span></div><div class="line">    <span class="vhdlchar">msw_irq_i</span>  <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- machine software interrupt</span></div><div class="line">    <span class="vhdlchar">mext_irq_i</span> <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="keyword">  -- machine external interrupt</span></div><div class="line">  <span class="vhdlchar">)</span>;</div><div class="line"><span class="keywordflow">end</span> <span class="vhdlchar">neorv32_top</span>;</div></div><!-- fragment --><p>This overview is just a short excerpt from the <em>Let's Get It Started</em> section of the NEORV32 documentary:</p>
<p><a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 data sheet</a></p>
<p>At first you need the <b>RISC-V GCC toolchain</b>. You can either <a href="https://github.com/riscv/riscv-gnu-toolchain">download the sources</a> and build the toolchain by yourself, or you can download a prebuilt one and install it.</p>
<p>:warning: Keep in mind that – for instance – a <code>rv32imc</code> toolchain only provides library code compiled with compressed and <code>mul</code>/<code>div</code> instructions! Hence, this code cannot be executed (without emulation) on an architecture without these extensions!</p>
<p>To build the toolchain by yourself, follow the official <a href="https://github.com/riscv/riscv-gnu-toolchain">build instructions</a>. Make sure to use the <code>ilp32</code> or <code>ilp32e</code> ABI.</p>
<p><b>Alternatively</b>, you can download a prebuilt toolchain. I have uploaded the toolchains I am using to GitHub. These toolchains were compiled on a 64-bit x86 Ubuntu 20.04 LTS (Ubuntu on Windows, actually). Download the toolchain of choice:</p>
<p><a href="https://github.com/stnolting/riscv_gcc_prebuilt">https://github.com/stnolting/riscv_gcc_prebuilt</a></p>
<p>Get the sources of the NEORV32 Processor project. The simplest way is using <code>git clone</code> (suggested for easy project updates via <code>git pull</code>): </p><pre class="fragment">$ git clone https://github.com/stnolting/neorv32.git
</pre><p>Alternatively, you can either download a specific <a href="https://github.com/stnolting/neorv32/releases">release</a> or get the most recent version of this project as <a href="https://github.com/stnolting/neorv32/archive/master.zip"><code>*.zip</code> file</a>.</p>
<p>Create a new project with your FPGA design tool of choice. Add all the <code>*.vhd</code> files from the <a href="https://github.com/stnolting/neorv32/blob/master/rtl"><code>rtl/core</code></a> folder to this project. Make sure to add these files to a <b>new design library</b> called <code>neorv32</code>.</p>
<p>You can either instantiate the <a href="https://github.com/stnolting/neorv32#top-entity">processor's top entity</a> in your own project or you can use a simple <a href="https://github.com/stnolting/neorv32/blob/master/rtl/top_templates/neorv32_test_setup.vhd">test setup</a> (from the project's <a href="https://github.com/stnolting/neorv32/blob/master/rtl/top_templates"><code>rtl/top_templates</code></a> folder) as top entity.</p>
<p>This test setup instantiates the processor and implements most of the peripherals and some ISA extensions. Only the UART lines, clock, reset and some GPIO output sginals are propagated as actual entity signals. Basically, it is a FPGA "hello world" example:</p>
<div class="fragment"><div class="line"><span class="keywordflow">entity </span>neorv32_test_setup <span class="keywordflow">is</span></div><div class="line">  <span class="keywordflow">port</span> <span class="vhdlchar">(</span></div><div class="line"><span class="keyword">    -- Global control --</span></div><div class="line">    <span class="vhdlchar">clk_i</span>      <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global clock, rising edge</span></div><div class="line">    <span class="vhdlchar">rstn_i</span>     <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span>;<span class="keyword"> -- global reset, low-active, async</span></div><div class="line"><span class="keyword">    -- GPIO --</span></div><div class="line">    <span class="vhdlchar">gpio_o</span>     <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic_vector</span><span class="vhdlchar">(</span><span class="vhdllogic"></span><span class="vhdllogic">7</span> <span class="keywordflow">downto</span> <span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">)</span>;<span class="keyword"> -- parallel output</span></div><div class="line"><span class="keyword">    -- UART --</span></div><div class="line">    <span class="vhdlchar">uart_txd_o</span> <span class="vhdlchar">:</span> <span class="keywordflow">out</span> <span class="comment">std_ulogic</span>;<span class="keyword"> -- UART send data</span></div><div class="line">    <span class="vhdlchar">uart_rxd_i</span> <span class="vhdlchar">:</span> <span class="keywordflow">in</span>  <span class="comment">std_ulogic</span> <span class="vhdlchar">:=</span> <span class="vhdlchar">&#39;</span><span class="vhdllogic"></span><span class="vhdllogic">0</span><span class="vhdlchar">&#39;</span><span class="keyword"> -- UART receive data</span></div><div class="line">  <span class="vhdlchar">)</span>;</div><div class="line"><span class="keywordflow">end</span> <span class="vhdlchar">neorv32_test_setup</span>;</div></div><!-- fragment --><p>Make sure <code>GNU Make</code> and a native <code>GCC</code> compiler are installed. To test the installation of the RISC-V toolchain navigate to an example project like <code>sw/example/blink_led</code> and run: </p><pre class="fragment">neorv32/sw/example/blink_led$ make check
</pre><p>The NEORV32 project includes some <a href="https://github.com/stnolting/neorv32/tree/master/sw/example">example programs</a> from which you can start your own application. Simply compile one of these projects. This will create a NEORV32 <em>executable</em> <code>neorv32_exe.bin</code> in the same folder: </p><pre class="fragment">neorv32/sw/example/blink_led$ make clean_all exe
</pre><p>Connect your FPGA board via UART to your computer and open the according port to interface with the NEORV32 bootloader. The bootloader uses the following default UART configuration:</p>
<ul>
<li>19200 Baud</li>
<li>8 data bits</li>
<li>1 stop bit</li>
<li>No parity bits</li>
<li>No transmission / flow control protocol (raw bytes only)</li>
<li>Newline on <code>\r\n</code> (carriage return &amp; newline) - also for sent data</li>
</ul>
<p>Use the bootloader console to upload the <code>neorv32_exe.bin</code> executable and run your application image.</p>
<div class="fragment"><div class="line">&lt;&lt; NEORV32 Bootloader &gt;&gt;</div><div class="line"></div><div class="line">BLDV: Jul  6 2020</div><div class="line">HWV:  1.0.1.0</div><div class="line">CLK:  0x0134FD90 Hz</div><div class="line">USER: 0x0001CE40</div><div class="line">MISA: 0x42801104</div><div class="line">PROC: 0x03FF0035</div><div class="line">IMEM: 0x00010000 bytes @ 0x00000000</div><div class="line">DMEM: 0x00010000 bytes @ 0x80000000</div><div class="line"></div><div class="line">Autoboot in 8s. Press key to abort.</div><div class="line">Aborted.</div><div class="line"></div><div class="line">Available CMDs:</div><div class="line"> h: Help</div><div class="line"> r: Restart</div><div class="line"> u: Upload</div><div class="line"> s: Store to flash</div><div class="line"> l: Load from flash</div><div class="line"> e: Execute</div><div class="line">CMD:&gt; u</div><div class="line">Awaiting neorv32_exe.bin... OK</div><div class="line">CMD:&gt; e</div><div class="line">Booting...</div><div class="line"></div><div class="line">Blinking LED demo program</div></div><!-- fragment --><p>Going further: Take a look at the <em>Let's Get It Started!</em> chapter of the <a href="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/NEORV32.pdf">NEORV32 data sheet</a>.</p>
<p>I'm always thankful for help! So if you have any questions, bug reports, ideas or if you want to give some kind of feedback, feel free to <a href="https://github.com/stnolting/neorv32/issues">open a new issue</a> or directly <a href="#" onclick="location.href='mai'+'lto:'+'stn'+'ol'+'tin'+'g@'+'gma'+'il'+'.co'+'m'; return false;">drop me a line</a>.</p>
<p>If you'd like to contribute:</p>
<ol type="1">
<li><a href="https://github.com/stnolting/neorv32/fork">Fork</a> this repository and clone the fork</li>
<li>Create a feature branch in your fork: <code>git checkout -b awesome_new_feature_branch</code></li>
<li>Create a new remote for the upstream repo: <code>git remote add <a href="https://github.com/stnolting/neorv32">https://github.com/stnolting/neorv32</a></code></li>
</ol>
<ol type="1">
<li>Commit your modifications: <code>git commit -m "Awesome new feature!"</code></li>
<li>Push to the branch: <code>git push origin awesome_new_feature_branch</code></li>
<li>Create a new <a href="https://github.com/stnolting/neorv32/pulls">pull request</a></li>
</ol>
<p>Please also check out the project's https://github.com/stnolting/neorv32/tree/master/CODE_OF_CONDUCT.md "code of conduct".</p>
<p>This project is released under the BSD 3-Clause license. No copyright infringement intended. Other implied or used projects might have different licensing - see their documentation to get more information.</p>
<p>If you are using the NEORV32 Processor/CPU in some kind of publication, please cite it as follows:</p>
<blockquote class="doxtable">
<p>S. Nolting, "The NEORV32 Processor/CPU", github.com/stnolting/neorv32 </p>
</blockquote>
<p>Copyright (c) 2020, Stephan Nolting. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol type="1">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>Our website contains links to the websites of third parties („external links“). As the content of these websites is not under our control, we cannot assume any liability for such external content. In all cases, the provider of information of the linked websites is liable for the content and accuracy of the information provided. At the point in time when the links were placed, no infringements of the law were recognisable to us. As soon as an infringement of the law becomes known to us, we will immediately remove the link in question.</p>
<p>"Artix" and "Vivado" are trademarks of Xilinx Inc.</p>
<p>"Cyclone", "Quartus Prime", "Quartus Prime Lite" and "Avalon Bus" are trademarks of Intel Corporation.</p>
<p>"Artix" and "Vivado" are trademarks of Xilinx, Inc.</p>
<p>"iCE40", "UltraPlus" and "Lattice Radiant" are trademarks of Lattice Semiconductor Corporation.</p>
<p>"AXI" and "AXI-Lite" are trademarks of Arm Holdings plc.</p>
<p><a href="https://riscv.org/"></a></p>
<p><a href="https://riscv.org/">RISC-V</a> - Instruction Sets Want To Be Free!</p>
<p><a href="https://travis-ci.com/stnolting/neorv32"></a></p>
<p>Continous integration provided by <a href="https://travis-ci.com/stnolting/neorv32">Travis CI</a> and powered by <a href="https://github.com/ghdl/ghdl">GHDL</a>.</p>
<div class="image">
<img src="https://raw.githubusercontent.com/stnolting/neorv32/master/docs/figures/oshw_logo.png" alt="Open Source Hardware Logo https://www.oshwa.org"/>
</div>
<p>This project is not affiliated with or endorsed by the Open Source Initiative (<a href="https://www.oshwa.org">https://www.oshwa.org</a> / <a href="https://opensource.org">https://opensource.org</a>). </p><hr/>
<p>This repository was created on June 23th, 2020.</p>
<p>Made with :coffee: in Hannover, Germany. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
